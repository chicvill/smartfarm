# MQTT ê¸°ë°˜ WiFi í”ŒëŸ¬ê·¸ì•¤í”Œë ˆì´ ìŠ¤ë§ˆíŠ¸íŒœ ì œì–´ ëª¨ë“ˆ
## ì„¤ê³„ ê³„íšì„œ

**í”„ë¡œì íŠ¸ëª…**: SmartFarm WiFi Control Module (SFWCM)  
**ë²„ì „**: 1.0  
**ì‘ì„±ì¼**: 2025ë…„ 10ì›” 20ì¼

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#2-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [í•˜ë“œì›¨ì–´ ì„¤ê³„](#3-í•˜ë“œì›¨ì–´-ì„¤ê³„)
4. [ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„](#4-ì†Œí”„íŠ¸ì›¨ì–´-ì„¤ê³„)
5. [MQTT í†µì‹  í”„ë¡œí† ì½œ](#5-mqtt-í†µì‹ -í”„ë¡œí† ì½œ)
6. [PCB ì„¤ê³„](#6-pcb-ì„¤ê³„)
7. [ëª¨ë“ˆ ì¢…ë¥˜ ë° ì‚¬ì–‘](#7-ëª¨ë“ˆ-ì¢…ë¥˜-ë°-ì‚¬ì–‘)
8. [ì œì‘ ë° ë¹„ìš©](#8-ì œì‘-ë°-ë¹„ìš©)
9. [ì„¤ì¹˜ ë° ì‚¬ìš©ë²•](#9-ì„¤ì¹˜-ë°-ì‚¬ìš©ë²•)
10. [í…ŒìŠ¤íŠ¸ ê³„íš](#10-í…ŒìŠ¤íŠ¸-ê³„íš)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ëª©ì 
**ì „ì›ì„ ë§Œ ì—°ê²°í•˜ë©´ WiFië¡œ ì„¼ì„œì™€ ì•¡ì¶”ì—ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆëŠ” í”ŒëŸ¬ê·¸ì•¤í”Œë ˆì´ ëª¨ë“ˆ ê°œë°œ**

### 1.2 í•µì‹¬ ê°œë…
```
ì „ì› ì—°ê²° â†’ WiFi ìë™ ì ‘ì† â†’ MQTT Broker ì—°ê²° â†’ ì„¼ì„œ ë°ì´í„° ì†¡ì‹ /ì œì–´ ëª…ë ¹ ìˆ˜ì‹ 
```

### 1.3 ì£¼ìš” íŠ¹ì§•
- âœ… **ì§„ì •í•œ í”ŒëŸ¬ê·¸ì•¤í”Œë ˆì´**: ì „ì›ë§Œ ê½‚ìœ¼ë©´ ìë™ ì‘ë™
- âœ… **WiFi í†µì‹ **: ë°°ì„  ì—†ì´ ë¬´ì„ ìœ¼ë¡œ ì—°ê²°
- âœ… **MQTT í”„ë¡œí† ì½œ**: ê²½ëŸ‰, ì €ì „ë ¥ í†µì‹ 
- âœ… **ëª¨ë“ˆì‹ ì„¤ê³„**: ì„¼ì„œ/ì•¡ì¶”ì—ì´í„° ëª¨ë“ˆ êµì²´ ê°€ëŠ¥
- âœ… **ìë™ ë³µêµ¬**: WiFi/MQTT ì—°ê²° ëŠê¹€ ì‹œ ìë™ ì¬ì—°ê²°
- âœ… **OTA ì—…ë°ì´íŠ¸**: ë¬´ì„ ìœ¼ë¡œ íŒì›¨ì–´ ì—…ë°ì´íŠ¸
- âœ… **ì €ë¹„ìš©**: ëª¨ë“ˆë‹¹ 5,000ì›~15,000ì›

### 1.4 ì ìš© ë¶„ì•¼
- ìŠ¤ë§ˆíŠ¸íŒœ í™˜ê²½ ëª¨ë‹ˆí„°ë§
- ìë™ ê´€ê°œ ì‹œìŠ¤í…œ
- ì˜¨ì‹¤ í™˜ê²½ ì œì–´
- ì–‘ì•¡ ê´€ë¦¬ ì‹œìŠ¤í…œ
- ì¡°ëª… ì œì–´
- í™˜í’ê¸°/ì°¨ê´‘ë§‰ ì œì–´

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì„±ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì¤‘ì•™ ì œì–´ ì‹œìŠ¤í…œ                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Raspberry Pi 4 (MQTT Broker + ëŒ€ì‹œë³´ë“œ)           â”‚   â”‚
â”‚  â”‚   - Mosquitto MQTT Broker                           â”‚   â”‚
â”‚  â”‚   - InfluxDB (ë°ì´í„° ì €ì¥)                          â”‚   â”‚
â”‚  â”‚   - Grafana (ì‹œê°í™”)                                â”‚   â”‚
â”‚  â”‚   - Node-RED (ìë™í™”)                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â†• WiFi Network                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†•
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                      â†“                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì„¼ì„œ ëª¨ë“ˆ 1  â”‚      â”‚  ì„¼ì„œ ëª¨ë“ˆ 2  â”‚     â”‚  ì•¡ì¶”ì—ì´í„°   â”‚
â”‚  (ì˜¨ìŠµë„)     â”‚      â”‚  (EC/pH)      â”‚     â”‚  ëª¨ë“ˆ 1       â”‚
â”‚               â”‚      â”‚               â”‚     â”‚  (ë¦´ë ˆì´)     â”‚
â”‚  ESP32-C3     â”‚      â”‚  ESP32-C3     â”‚     â”‚  ESP32-C3     â”‚
â”‚  + DHT22      â”‚      â”‚  + ECì„¼ì„œ     â”‚     â”‚  + 4ì±„ë„ë¦´ë ˆì´â”‚
â”‚  + ì „ì›       â”‚      â”‚  + pHì„¼ì„œ     â”‚     â”‚  + ì „ì›       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      WiFi                   WiFi                  WiFi
      MQTT                   MQTT                  MQTT
```

### 2.2 í†µì‹  í”Œë¡œìš°

```
1. ëª¨ë“ˆ ë¶€íŒ…
   â†“
2. WiFi ì—°ê²° (ì €ì¥ëœ SSID/Password ë˜ëŠ” SmartConfig)
   â†“
3. MQTT Broker ì—°ê²° (Raspberry Pi)
   â†“
4. ê³ ìœ  Topic ë“±ë¡ (ì˜ˆ: smartfarm/zone1/sensor/temperature)
   â†“
5. ë°ì´í„° ì†¡ì‹  ë˜ëŠ” ì œì–´ ëª…ë ¹ ìˆ˜ì‹  ëŒ€ê¸°
   â†“
6. ì£¼ê¸°ì  ìƒíƒœ ë³´ê³  (Heartbeat)
```

### 2.3 ëª¨ë“ˆ ë¶„ë¥˜

**ì„¼ì„œ ëª¨ë“ˆ (Publisher)**
- í™˜ê²½ ë°ì´í„° ìˆ˜ì§‘
- ì£¼ê¸°ì ìœ¼ë¡œ MQTT Topicì— Publish
- ì €ì „ë ¥ ì„¤ê³„ (Deep Sleep ì§€ì›)

**ì•¡ì¶”ì—ì´í„° ëª¨ë“ˆ (Subscriber)**
- ì œì–´ ëª…ë ¹ ìˆ˜ì‹ 
- MQTT Topicì—ì„œ Subscribe
- ë¦´ë ˆì´/ëª¨í„°/ë°¸ë¸Œ ì œì–´

**í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“ˆ (Pub/Sub)**
- ì„¼ì„œ + ì•¡ì¶”ì—ì´í„° í†µí•©
- ì–‘ë°©í–¥ í†µì‹ 

---

## 3. í•˜ë“œì›¨ì–´ ì„¤ê³„

### 3.1 í•µì‹¬ MCU ì„ ì •

#### ESP32-C3 ì„ íƒ ì´ìœ 
| íŠ¹ì§• | ì‚¬ì–‘ | ì¥ì  |
|------|------|------|
| CPU | RISC-V 32-bit @ 160MHz | ì €ë¹„ìš©, ê³ ì„±ëŠ¥ |
| WiFi | 802.11 b/g/n | ì•ˆì •ì  ë¬´ì„  í†µì‹  |
| Bluetooth | BLE 5.0 | ì¶”ê°€ í™•ì¥ ê°€ëŠ¥ |
| GPIO | 22ê°œ | ì¶©ë¶„í•œ I/O |
| ADC | 12-bit, 6ì±„ë„ | ì•„ë‚ ë¡œê·¸ ì„¼ì„œ ì§€ì› |
| ì „ë ¥ | í™œì„± ~80mA, Sleep ~5Î¼A | ì €ì „ë ¥ |
| ê°€ê²© | $1.5~2 | ë§¤ìš° ì €ë ´ |
| í¬ê¸° | QFN32 (5Ã—5mm) | ì†Œí˜• |

**ëŒ€ì•ˆ**: ESP32-S3 (ì¹´ë©”ë¼ í•„ìš” ì‹œ), ESP8266 (ì´ˆì €ë¹„ìš©)

### 3.2 í‘œì¤€ ëª¨ë“ˆ í•˜ë“œì›¨ì–´ ë¸”ë¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              í‘œì¤€ WiFi ì œì–´ ëª¨ë“ˆ                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ ì „ì›ë¶€   â”‚â”€â”€â”€â–¶â”‚   ESP32-C3   â”‚                â”‚
â”‚  â”‚ 5Vâ†’3.3V  â”‚    â”‚              â”‚                â”‚
â”‚  â”‚ AMS1117  â”‚    â”‚  WiFi + BLE  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚                â”‚
â”‚                  â”‚  RISC-V MCU  â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  â”‚  LED     â”‚           â”‚                        â”‚
â”‚  â”‚ ìƒíƒœí‘œì‹œ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                        â”‚
â”‚                         â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                        â”‚
â”‚  â”‚ ì„¼ì„œ/    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚  â”‚ì•¡ì¶”ì—ì´í„°â”‚           â”‚                        â”‚
â”‚  â”‚ ì¸í„°í˜ì´ìŠ¤â”‚           â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                        â”‚
â”‚      â†•                  â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                        â”‚
â”‚  â”‚ ì»¤ë„¥í„°   â”‚           â”‚                        â”‚
â”‚  â”‚ (ì„ íƒ)   â”‚           â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                  â”‚   í”Œë˜ì‹œ      â”‚                â”‚
â”‚  ì „ì› ì…ë ¥       â”‚   4MB        â”‚                â”‚
â”‚  5V DC          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  (Micro USB                                      â”‚
â”‚   ë˜ëŠ” ë‹¨ìëŒ€)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ì „ì› ì„¤ê³„

#### ì…ë ¥ ì „ì›
- **ì…ë ¥ ì „ì••**: 5V DC (USB ë˜ëŠ” ì™¸ë¶€ ì „ì›)
- **ìµœëŒ€ ì „ë¥˜**: 500mA~2A (ëª¨ë“ˆ ì¢…ë¥˜ì— ë”°ë¼)
- **ì»¤ë„¥í„°**: Micro USB ë˜ëŠ” ë‹¨ìëŒ€ (Phoenix Connector)

#### ì „ì•• ë ˆê·¤ë ˆì´í„°
- **3.3V LDO**: AMS1117-3.3 (1A ì¶œë ¥)
- **ì…ë ¥ ë³´í˜¸**: ì—­ì „ì•• ë³´í˜¸ ë‹¤ì´ì˜¤ë“œ
- **í•„í„°ë§**: 
  - ì…ë ¥: 100Î¼F ì „í•´ + 100nF ì„¸ë¼ë¯¹
  - ì¶œë ¥: 22Î¼F ì „í•´ + 100nF ì„¸ë¼ë¯¹

#### ì „ë ¥ ì†Œë¹„
| ëª¨ë“œ | ì „ë¥˜ | ì„¤ëª… |
|------|------|------|
| Active (WiFi TX) | ~160mA | ë°ì´í„° ì†¡ì‹  ì¤‘ |
| Active (WiFi RX) | ~80mA | ëŒ€ê¸° ì¤‘ |
| Modem Sleep | ~20mA | WiFi ì—°ê²° ìœ ì§€ |
| Light Sleep | ~800Î¼A | ì£¼ê¸°ì  Wake-up |
| Deep Sleep | ~5Î¼A | ê±°ì˜ êº¼ì§ |

### 3.4 ì„¼ì„œ ì¸í„°í˜ì´ìŠ¤

#### ë””ì§€í„¸ ì„¼ì„œ (I2C, 1-Wire, UART)
```
ESP32-C3 GPIO
  â”œâ”€ GPIO 4, 5: I2C (SDA, SCL) - Pull-up 4.7kÎ©
  â”œâ”€ GPIO 6: 1-Wire (Dallas DS18B20 ë“±)
  â”œâ”€ GPIO 20, 21: UART (TX, RX)
  â””â”€ GPIO 8, 9: SPI (MOSI, MISO) - ì„ íƒì 
```

#### ì•„ë‚ ë¡œê·¸ ì„¼ì„œ
```
ESP32-C3 ADC
  â”œâ”€ GPIO 0~4: ADC1 (12-bit, 0~3.3V)
  â”‚   - í† ì–‘ ìˆ˜ë¶„ ì„¼ì„œ
  â”‚   - ì¡°ë„ ì„¼ì„œ (í¬í† ë‹¤ì´ì˜¤ë“œ)
  â”‚   - ì „ì••/ì „ë¥˜ ì¸¡ì •
  â””â”€ ì£¼ì˜: WiFi ì‚¬ìš© ì‹œ ADC2 ì‚¬ìš© ë¶ˆê°€
```

### 3.5 ì•¡ì¶”ì—ì´í„° ì¸í„°í˜ì´ìŠ¤

#### ë¦´ë ˆì´ ì œì–´
```
ESP32-C3 GPIO â†’ íŠ¸ëœì§€ìŠ¤í„° â†’ ë¦´ë ˆì´ ì½”ì¼
  - GPIO ì¶œë ¥ (3.3V, ìµœëŒ€ 40mA)
  - NPN íŠ¸ëœì§€ìŠ¤í„° (2N2222, BC547)
  - í”Œë¼ì´ë°± ë‹¤ì´ì˜¤ë“œ (1N4007)
  - ë¦´ë ˆì´: 5V ì½”ì¼, 10A ì ‘ì 
```

**íšŒë¡œ ì˜ˆì‹œ**:
```
GPIO 10 â”€â”€â”¬â”€ 1kÎ© â”€â”€â”€ BC547 Base
          â”‚               â”‚ Collector
          â””â”€ 10kÎ© â”€â”€â”€ GND â”‚
                          â”‚
                     Relay Coil (+5V)
                          â”‚
                     1N4007 (Flyback)
                          â”‚
                         GND
```

#### ëª¨í„°/ë°¸ë¸Œ ì œì–´
```
ESP32-C3 GPIO â†’ MOSFET â†’ ëª¨í„°/ì†”ë ˆë…¸ì´ë“œ
  - Logic-level MOSFET (IRLZ44N, 2A ì´ìƒ)
  - ë˜ëŠ” L298N ëª¨í„° ë“œë¼ì´ë²„ IC
```

---

## 4. ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„

### 4.1 íŒì›¨ì–´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Application Layer             â”‚
â”‚  - ì„¼ì„œ ì½ê¸° / ì•¡ì¶”ì—ì´í„° ì œì–´         â”‚
â”‚  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          MQTT Client Layer              â”‚
â”‚  - Publish / Subscribe                  â”‚
â”‚  - QoS ê´€ë¦¬                             â”‚
â”‚  - ë©”ì‹œì§€ í                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           WiFi Manager                  â”‚
â”‚  - WiFi ì—°ê²° ê´€ë¦¬                       â”‚
â”‚  - SmartConfig / WPS                    â”‚
â”‚  - ìë™ ì¬ì—°ê²°                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ESP-IDF / Arduino Core           â”‚
â”‚  - Hardware Abstraction Layer           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„

#### 4.2.1 WiFi ìë™ ì—°ê²°

```cpp
// WiFi ì„¤ì • êµ¬ì¡°ì²´
struct WiFiConfig {
    char ssid[32];
    char password[64];
    bool saved;
};

// WiFi ì—°ê²° í•¨ìˆ˜
void connectWiFi() {
    WiFiConfig config;
    
    // ì €ì¥ëœ ì„¤ì • ë¡œë“œ (NVS)
    if (loadWiFiConfig(&config) && config.saved) {
        // ì €ì¥ëœ SSIDë¡œ ì—°ê²° ì‹œë„
        WiFi.begin(config.ssid, config.password);
        
        // 30ì´ˆ ëŒ€ê¸°
        int timeout = 30;
        while (WiFi.status() != WL_CONNECTED && timeout-- > 0) {
            delay(1000);
            Serial.print(".");
        }
        
        if (WiFi.status() == WL_CONNECTED) {
            Serial.println("WiFi Connected!");
            return;
        }
    }
    
    // ì—°ê²° ì‹¤íŒ¨ ì‹œ SmartConfig ëª¨ë“œ
    Serial.println("Starting SmartConfig...");
    WiFi.beginSmartConfig();
    
    // SmartConfig ëŒ€ê¸°
    while (!WiFi.smartConfigDone()) {
        delay(500);
        Serial.print(".");
    }
    
    Serial.println("SmartConfig done!");
    
    // ìƒˆ ì„¤ì • ì €ì¥
    strcpy(config.ssid, WiFi.SSID().c_str());
    strcpy(config.password, WiFi.psk().c_str());
    config.saved = true;
    saveWiFiConfig(&config);
}

// WiFi ì¬ì—°ê²° (ë°±ê·¸ë¼ìš´ë“œ)
void WiFiKeepAlive(void *parameter) {
    while (1) {
        if (WiFi.status() != WL_CONNECTED) {
            Serial.println("WiFi disconnected. Reconnecting...");
            WiFi.reconnect();
        }
        vTaskDelay(10000 / portTICK_PERIOD_MS); // 10ì´ˆë§ˆë‹¤ ì²´í¬
    }
}
```

#### 4.2.2 MQTT í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„

```cpp
#include <WiFi.h>
#include <PubSubClient.h>

WiFiClient espClient;
PubSubClient mqtt(espClient);

// MQTT ì„¤ì •
const char* MQTT_SERVER = "192.168.1.100"; // Raspberry Pi IP
const int MQTT_PORT = 1883;
const char* MQTT_USER = "smartfarm";       // ì„ íƒì 
const char* MQTT_PASS = "password";        // ì„ íƒì 

// Topic ì„¤ì • (ëª¨ë“ˆ ID ê¸°ë°˜)
String MODULE_ID = "zone1_temp";
String TOPIC_PUB = "smartfarm/" + MODULE_ID + "/data";
String TOPIC_SUB = "smartfarm/" + MODULE_ID + "/control";
String TOPIC_STATUS = "smartfarm/" + MODULE_ID + "/status";

// MQTT ì½œë°± (ë©”ì‹œì§€ ìˆ˜ì‹ )
void mqttCallback(char* topic, byte* payload, unsigned int length) {
    Serial.print("Message received on topic: ");
    Serial.println(topic);
    
    // Payloadë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜
    String message = "";
    for (int i = 0; i < length; i++) {
        message += (char)payload[i];
    }
    
    Serial.print("Message: ");
    Serial.println(message);
    
    // JSON íŒŒì‹± ë° ì œì–´ ë¡œì§
    handleControlMessage(message);
}

// MQTT ì—°ê²°
void connectMQTT() {
    while (!mqtt.connected()) {
        Serial.print("Connecting to MQTT broker...");
        
        String clientId = "ESP32-" + MODULE_ID;
        
        if (mqtt.connect(clientId.c_str(), MQTT_USER, MQTT_PASS)) {
            Serial.println("connected");
            
            // ì˜¨ë¼ì¸ ìƒíƒœ ë°œí–‰
            mqtt.publish(TOPIC_STATUS.c_str(), "online", true);
            
            // Subscribe (ì•¡ì¶”ì—ì´í„° ëª¨ë“ˆë§Œ)
            mqtt.subscribe(TOPIC_SUB.c_str());
            
            Serial.println("MQTT ready");
        } else {
            Serial.print("failed, rc=");
            Serial.print(mqtt.state());
            Serial.println(" retry in 5 seconds");
            delay(5000);
        }
    }
}

// MQTT ì´ˆê¸°í™”
void setupMQTT() {
    mqtt.setServer(MQTT_SERVER, MQTT_PORT);
    mqtt.setCallback(mqttCallback);
    mqtt.setKeepAlive(60); // Heartbeat 60ì´ˆ
}

// MQTT ë£¨í”„ (ì—°ê²° ìœ ì§€)
void mqttLoop() {
    if (!mqtt.connected()) {
        connectMQTT();
    }
    mqtt.loop();
}
```

#### 4.2.3 ì„¼ì„œ ë°ì´í„° ë°œí–‰ ì˜ˆì‹œ

```cpp
#include <DHT.h>
#include <ArduinoJson.h>

#define DHTPIN 4
#define DHTTYPE DHT22
DHT dht(DHTPIN, DHTTYPE);

unsigned long lastPublish = 0;
const long PUBLISH_INTERVAL = 60000; // 1ë¶„

void publishSensorData() {
    unsigned long now = millis();
    
    if (now - lastPublish >= PUBLISH_INTERVAL) {
        lastPublish = now;
        
        // ì„¼ì„œ ì½ê¸°
        float temp = dht.readTemperature();
        float humi = dht.readHumidity();
        
        if (isnan(temp) || isnan(humi)) {
            Serial.println("Failed to read sensor!");
            return;
        }
        
        // JSON ìƒì„±
        StaticJsonDocument<200> doc;
        doc["temperature"] = temp;
        doc["humidity"] = humi;
        doc["timestamp"] = millis() / 1000;
        
        String json;
        serializeJson(doc, json);
        
        // MQTT ë°œí–‰
        mqtt.publish(TOPIC_PUB.c_str(), json.c_str());
        
        Serial.print("Published: ");
        Serial.println(json);
    }
}

void loop() {
    mqttLoop();
    publishSensorData();
    delay(100);
}
```

#### 4.2.4 ì•¡ì¶”ì—ì´í„° ì œì–´ ì˜ˆì‹œ

```cpp
#define RELAY1_PIN 10
#define RELAY2_PIN 11
#define RELAY3_PIN 12
#define RELAY4_PIN 13

void setupActuator() {
    pinMode(RELAY1_PIN, OUTPUT);
    pinMode(RELAY2_PIN, OUTPUT);
    pinMode(RELAY3_PIN, OUTPUT);
    pinMode(RELAY4_PIN, OUTPUT);
    
    // ì´ˆê¸° ìƒíƒœ OFF
    digitalWrite(RELAY1_PIN, LOW);
    digitalWrite(RELAY2_PIN, LOW);
    digitalWrite(RELAY3_PIN, LOW);
    digitalWrite(RELAY4_PIN, LOW);
}

void handleControlMessage(String message) {
    // JSON íŒŒì‹±
    StaticJsonDocument<200> doc;
    DeserializationError error = deserializeJson(doc, message);
    
    if (error) {
        Serial.println("JSON parse failed!");
        return;
    }
    
    // ì œì–´ ëª…ë ¹ ì²˜ë¦¬
    if (doc.containsKey("relay1")) {
        bool state = doc["relay1"];
        digitalWrite(RELAY1_PIN, state ? HIGH : LOW);
        Serial.print("Relay 1: ");
        Serial.println(state ? "ON" : "OFF");
    }
    
    if (doc.containsKey("relay2")) {
        bool state = doc["relay2"];
        digitalWrite(RELAY2_PIN, state ? HIGH : LOW);
    }
    
    // ìƒíƒœ í”¼ë“œë°± ë°œí–‰
    publishActuatorStatus();
}

void publishActuatorStatus() {
    StaticJsonDocument<200> doc;
    doc["relay1"] = digitalRead(RELAY1_PIN);
    doc["relay2"] = digitalRead(RELAY2_PIN);
    doc["relay3"] = digitalRead(RELAY3_PIN);
    doc["relay4"] = digitalRead(RELAY4_PIN);
    
    String json;
    serializeJson(doc, json);
    
    mqtt.publish(TOPIC_PUB.c_str(), json.c_str());
}
```

### 4.3 OTA (Over-The-Air) ì—…ë°ì´íŠ¸

```cpp
#include <ArduinoOTA.h>

void setupOTA() {
    ArduinoOTA.setHostname(MODULE_ID.c_str());
    ArduinoOTA.setPassword("admin"); // ë³´ì•ˆ ë¹„ë°€ë²ˆí˜¸
    
    ArduinoOTA.onStart([]() {
        String type;
        if (ArduinoOTA.getCommand() == U_FLASH) {
            type = "sketch";
        } else { // U_SPIFFS
            type = "filesystem";
        }
        Serial.println("Start updating " + type);
    });
    
    ArduinoOTA.onEnd([]() {
        Serial.println("\nEnd");
    });
    
    ArduinoOTA.onProgress([](unsigned int progress, unsigned int total) {
        Serial.printf("Progress: %u%%\r", (progress / (total / 100)));
    });
    
    ArduinoOTA.onError([](ota_error_t error) {
        Serial.printf("Error[%u]: ", error);
        if (error == OTA_AUTH_ERROR) Serial.println("Auth Failed");
        else if (error == OTA_BEGIN_ERROR) Serial.println("Begin Failed");
        else if (error == OTA_CONNECT_ERROR) Serial.println("Connect Failed");
        else if (error == OTA_RECEIVE_ERROR) Serial.println("Receive Failed");
        else if (error == OTA_END_ERROR) Serial.println("End Failed");
    });
    
    ArduinoOTA.begin();
}

void loop() {
    ArduinoOTA.handle();
    mqttLoop();
    publishSensorData();
}
```

---

## 5. MQTT í†µì‹  í”„ë¡œí† ì½œ

### 5.1 Topic êµ¬ì¡° ì„¤ê³„

```
smartfarm/
â”œâ”€â”€ zone1/                      # êµ¬ì—­ 1
â”‚   â”œâ”€â”€ sensor/
â”‚   â”‚   â”œâ”€â”€ temperature         # ì˜¨ë„ ì„¼ì„œ
â”‚   â”‚   â”œâ”€â”€ humidity            # ìŠµë„ ì„¼ì„œ
â”‚   â”‚   â”œâ”€â”€ ec                  # EC ì„¼ì„œ
â”‚   â”‚   â””â”€â”€ ph                  # pH ì„¼ì„œ
â”‚   â”œâ”€â”€ actuator/
â”‚   â”‚   â”œâ”€â”€ pump1/control       # íŒí”„ ì œì–´ (Subscribe)
â”‚   â”‚   â”œâ”€â”€ pump1/status        # íŒí”„ ìƒíƒœ (Publish)
â”‚   â”‚   â”œâ”€â”€ valve1/control
â”‚   â”‚   â””â”€â”€ valve1/status
â”‚   â””â”€â”€ status/
â”‚       â”œâ”€â”€ module1             # ëª¨ë“ˆ ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸
â”‚       â””â”€â”€ module2
â”‚
â”œâ”€â”€ zone2/                      # êµ¬ì—­ 2
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ control/                    # ì „ì—­ ì œì–´
â”‚   â”œâ”€â”€ all/emergency_stop      # ê¸´ê¸‰ ì •ì§€
â”‚   â””â”€â”€ broadcast               # ì „ì²´ ë°©ì†¡
â”‚
â””â”€â”€ system/                     # ì‹œìŠ¤í…œ ë©”íƒ€
    â”œâ”€â”€ discovery               # ìë™ ë°œê²¬
    â”œâ”€â”€ config                  # ì„¤ì • ë°°í¬
    â””â”€â”€ ota                     # OTA ì—…ë°ì´íŠ¸
```

### 5.2 ë©”ì‹œì§€ í¬ë§· (JSON)

#### ì„¼ì„œ ë°ì´í„°
```json
{
    "sensor_id": "zone1_temp_humi",
    "type": "DHT22",
    "timestamp": 1697845200,
    "data": {
        "temperature": 25.3,
        "humidity": 65.2
    },
    "unit": {
        "temperature": "Â°C",
        "humidity": "%"
    },
    "quality": "good"
}
```

#### ì œì–´ ëª…ë ¹
```json
{
    "command": "set",
    "actuator_id": "zone1_pump1",
    "action": "turn_on",
    "duration": 300,
    "timestamp": 1697845200
}
```

#### ìƒíƒœ í”¼ë“œë°±
```json
{
    "module_id": "zone1_pump1",
    "status": "running",
    "uptime": 86400,
    "wifi_rssi": -45,
    "free_heap": 180000,
    "timestamp": 1697845200
}
```

### 5.3 QoS ë ˆë²¨ ì„¤ì •

| Topic | QoS | ì´ìœ  |
|-------|-----|------|
| sensor/* | 0 | ì£¼ê¸°ì  ë°ì´í„°, ì†ì‹¤ í—ˆìš© |
| actuator/*/control | 1 | ì œì–´ ëª…ë ¹, ìµœì†Œ 1íšŒ ì „ë‹¬ |
| status/* | 1 | ìƒíƒœ ì •ë³´, ì‹ ë¢°ì„± í•„ìš” |
| control/all/* | 2 | ê¸´ê¸‰ ëª…ë ¹, ì •í™•íˆ 1íšŒ |

### 5.4 Retained Message í™œìš©

```cpp
// ëª¨ë“ˆ ì˜¨ë¼ì¸ ìƒíƒœ (LWT ì„¤ì •)
mqtt.publish("smartfarm/zone1/status/module1", "online", true);

// Last Will and Testament (ì—°ê²° ëŠê¹€ ì‹œ ìë™ ë°œí–‰)
mqtt.setWill("smartfarm/zone1/status/module1", "offline", true, 1);
```

---

## 6. PCB ì„¤ê³„

### 6.1 PCB ì‚¬ì–‘

| í•­ëª© | ì‚¬ì–‘ |
|------|------|
| í¬ê¸° | 50mm Ã— 40mm (í‘œì¤€í˜•) |
| ì¸µìˆ˜ | 2ì¸µ (Top, Bottom) |
| ê¸°íŒ ì¬ì§ˆ | FR-4, 1.6mm |
| ë™ë°• ë‘ê»˜ | 1oz (35Î¼m) |
| ìµœì†Œ ì„ í­/ê°„ê²© | 0.2mm / 0.2mm |
| ì‹¤í¬ìŠ¤í¬ë¦° | ì–‘ë©´ |
| ì†”ë”ë§ˆìŠ¤í¬ | ë…¹ìƒ‰ (ì–‘ë©´) |
| í‘œë©´ì²˜ë¦¬ | HASL (ë¬´ì—°) |

### 6.2 PCB ë ˆì´ì•„ì›ƒ ê°€ì´ë“œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ì „ì› ì…ë ¥]  Micro USB ë˜ëŠ” ë‹¨ìëŒ€          â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ì „ì›ë¶€  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   ESP32-C3   â”‚      â”‚
â”‚  â”‚ LDO     â”‚         â”‚              â”‚      â”‚
â”‚  â”‚ 3.3V    â”‚         â”‚   (ì¤‘ì•™ë°°ì¹˜) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                             â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ LED     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   GPIO      â”‚       â”‚
â”‚  â”‚ ìƒíƒœë“±  â”‚         â”‚   í—¤ë”      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                              â”‚
â”‚  [ì„¼ì„œ/ì•¡ì¶”ì—ì´í„° ì»¤ë„¥í„°]                    â”‚
â”‚   - JST-XH ì»¤ë„¥í„° (3~6í•€)                   â”‚
â”‚   - ë˜ëŠ” ë‚˜ì‚¬ì‹ ë‹¨ìëŒ€                       â”‚
â”‚                                              â”‚
â”‚  [í”„ë¡œê·¸ë˜ë° í—¤ë”]                           â”‚
â”‚   - 2.54mm í•€í—¤ë” (TX, RX, GND, 3.3V)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ë ˆì´ì–´ë³„ ì„¤ê³„

**Top Layer (ë¶€í’ˆë©´)**
```
- ESP32-C3 ëª¨ë“ˆ (ì¤‘ì•™)
- LDO ë ˆê·¤ë ˆì´í„°
- ë””ì»¤í”Œë§ ì»¤íŒ¨ì‹œí„° (ESP32 ì£¼ë³€ì— ê·¼ì ‘ ë°°ì¹˜)
- LED, ì €í•­
- ì»¤ë„¥í„° (ì „ì›, ì„¼ì„œ)
```

**Bottom Layer (ë‚©ë•œë©´)**
```
- GND Plane (ì „ì²´ ë©´ì ì˜ 80% ì´ìƒ)
- ì „ì› ë¼ì¸ (êµµê²Œ, 20mil ì´ìƒ)
- ë¦¬í„´ íŒ¨ìŠ¤ ìµœì†Œí™”
```

### 6.4 ì•ˆí…Œë‚˜ ì„¤ê³„ ê³ ë ¤ì‚¬í•­

**ESP32-C3 ë‚´ì¥ ì•ˆí…Œë‚˜ ì‚¬ìš© ì‹œ**
```
- PCB ê°€ì¥ìë¦¬ì— ë°°ì¹˜
- ì•ˆí…Œë‚˜ ì•„ë˜ 50mm Ã— 20mm ì˜ì—­ Keep-Out
- GND Plane ì—†ìŒ (ì•ˆí…Œë‚˜ ì„±ëŠ¥ ì €í•˜ ë°©ì§€)
- ê¸ˆì† ì¼€ì´ìŠ¤ ì‚¬ìš© ì‹œ ì™¸ë¶€ ì•ˆí…Œë‚˜ í•„ìš”
```

**ì™¸ë¶€ ì•ˆí…Œë‚˜ (ì„ íƒì )**
```
- U.FL / IPEX ì»¤ë„¥í„°
- 2.4GHz ì „ìš© ì•ˆí…Œë‚˜ (3dBi~5dBi)
- 50Î© ì„í”¼ë˜ìŠ¤ ë§¤ì¹­
```

### 6.5 íšŒë¡œë„ ì˜ˆì‹œ (ì„¼ì„œ ëª¨ë“ˆ)

```
                    +5V
                     â”‚
                  â”Œâ”€â”€â”´â”€â”€â”
                  â”‚     â”‚
                 100Î¼F 100nF
                  â”‚     â”‚
                  â””â”€â”€â”¬â”€â”€â”˜
                     â”‚
                  â”Œâ”€â”€â–¼â”€â”€â”€â”
  Micro USB â”€â”€â”€â”€â”€â–¶â”‚AMS1117â”‚
  5V               â”‚ 3.3V â”‚
                   â””â”€â”€â”€â”¬â”€â”€â”˜
                       â”‚ +3.3V
                    â”Œâ”€â”€â”´â”€â”€â”
                    â”‚     â”‚
                   22Î¼F 100nF
                    â”‚     â”‚
                    â””â”€â”€â”¬â”€â”€â”˜
                       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚      ESP32-C3           â”‚
            â”‚                         â”‚
  DHT22 â”€â”€â”€â”€â”¤ GPIO4 (Data)           â”‚
            â”‚                         â”‚
  I2C SDA â”€â”€â”¤ GPIO5 (SDA)            â”‚
  I2C SCL â”€â”€â”¤ GPIO6 (SCL)            â”‚
            â”‚                         â”‚
  LED â”€â”€â”€â”€â”€â”€â”¤ GPIO8 (Status)         â”‚
            â”‚                         â”‚
  Button â”€â”€â”€â”¤ GPIO9 (Boot/Reset)     â”‚
            â”‚                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                      GND
```

---

## 7. ëª¨ë“ˆ ì¢…ë¥˜ ë° ì‚¬ì–‘

### 7.1 ì„¼ì„œ ëª¨ë“ˆ

#### 7.1.1 ì˜¨ìŠµë„ ì„¼ì„œ ëª¨ë“ˆ

**ì‚¬ì–‘**
- MCU: ESP32-C3
- ì„¼ì„œ: DHT22 ë˜ëŠ” SHT31
- ì¸¡ì • ë²”ìœ„:
  - ì˜¨ë„: -40~80Â°C (ì •í™•ë„ Â±0.5Â°C)
  - ìŠµë„: 0~100% RH (ì •í™•ë„ Â±2%)
- ìƒ˜í”Œë§: 1ë¶„ ê°„ê²©
- ì „ë ¥: í‰ê·  80mA

**BOM (Bill of Materials)**
| ë¶€í’ˆ | ìˆ˜ëŸ‰ | ë‹¨ê°€ | í•©ê³„ |
|------|------|------|------|
| ESP32-C3 ëª¨ë“ˆ | 1 | 3,000ì› | 3,000ì› |
| DHT22 ì„¼ì„œ | 1 | 2,000ì› | 2,000ì› |
| AMS1117-3.3 | 1 | 300ì› | 300ì› |
| ì»¤íŒ¨ì‹œí„°, ì €í•­ | - | 500ì› | 500ì› |
| PCB | 1 | 2,000ì› | 2,000ì› |
| ì»¤ë„¥í„° | 2 | 500ì› | 1,000ì› |
| **ì´ê³„** | | | **8,800ì›** |

---

#### 7.1.2 EC/pH ì„¼ì„œ ëª¨ë“ˆ

**ì‚¬ì–‘**
- MCU: ESP32-C3
- ì„¼ì„œ: 
  - EC ì„¼ì„œ (TDS ì¸¡ì •)
  - pH ì„¼ì„œ (BNC ì»¤ë„¥í„°)
- ì¸¡ì • ë²”ìœ„:
  - EC: 0~10 mS/cm
  - pH: 0~14
- ìƒ˜í”Œë§: 5ë¶„ ê°„ê²©
- ë³´ì •: ìë™ ì˜¨ë„ ë³´ìƒ
- ì „ë ¥: í‰ê·  100mA

**BOM**
| ë¶€í’ˆ | ìˆ˜ëŸ‰ | ë‹¨ê°€ | í•©ê³„ |
|------|------|------|------|
| ESP32-C3 ëª¨ë“ˆ | 1 | 3,000ì› | 3,000ì› |
| EC ì„¼ì„œ | 1 | 8,000ì› | 8,000ì› |
| pH ì„¼ì„œ | 1 | 12,000ì› | 12,000ì› |
| BNC ì»¤ë„¥í„° | 2 | 1,000ì› | 2,000ì› |
| ì‹ í˜¸ ì¡°ì • íšŒë¡œ | 1 | 3,000ì› | 3,000ì› |
| ê¸°íƒ€ ë¶€í’ˆ | - | 2,000ì› | 2,000ì› |
| **ì´ê³„** | | | **30,000ì›** |

---

#### 7.1.3 í† ì–‘ ì„¼ì„œ ëª¨ë“ˆ

**ì‚¬ì–‘**
- MCU: ESP32-C3
- ì„¼ì„œ: ìš©ëŸ‰í˜• í† ì–‘ ìˆ˜ë¶„ ì„¼ì„œ
- ì¸¡ì •: í† ì–‘ ìˆ˜ë¶„ (0~100%)
- ìƒ˜í”Œë§: 10ë¶„ ê°„ê²©
- ì „ë ¥: í‰ê·  60mA

**BOM**
| ë¶€í’ˆ | ìˆ˜ëŸ‰ | ë‹¨ê°€ | í•©ê³„ |
|------|------|------|------|
| ESP32-C3 ëª¨ë“ˆ | 1 | 3,000ì› | 3,000ì› |
| í† ì–‘ ìˆ˜ë¶„ ì„¼ì„œ | 1 | 2,500ì› | 2,500ì› |
| ê¸°íƒ€ ë¶€í’ˆ | - | 2,000ì› | 2,000ì› |
| **ì´ê³„** | | | **7,500ì›** |

---

### 7.2 ì•¡ì¶”ì—ì´í„° ëª¨ë“ˆ

#### 7.2.1 4ì±„ë„ ë¦´ë ˆì´ ëª¨ë“ˆ

**ì‚¬ì–‘**
- MCU: ESP32-C3
- ë¦´ë ˆì´: 4ì±„ë„, 5V ì½”ì¼
- ì ‘ì : 10A @ 250V AC / 30V DC
- ìš©ë„: íŒí”„, í™˜í’ê¸°, ì¡°ëª… ì œì–´
- ë³´í˜¸: í”Œë¼ì´ë°± ë‹¤ì´ì˜¤ë“œ, LED í‘œì‹œ
- ì „ë ¥: í‰ê·  150mA

**ì œì–´ ì˜ˆì‹œ**
```json
{
    "relay1": true,   // íŒí”„ ON
    "relay2": false,  // í™˜í’ê¸° OFF
    "relay3": true,   // ì¡°ëª… ON
    "relay4": false   // ì˜ˆë¹„
}
```

**BOM**
| ë¶€í’ˆ | ìˆ˜ëŸ‰ | ë‹¨ê°€ | í•©ê³„ |
|------|------|------|------|
| ESP32-C3 ëª¨ë“ˆ | 1 | 3,000ì› | 3,000ì› |
| 5V ë¦´ë ˆì´ | 4 | 1,500ì› | 6,000ì› |
| íŠ¸ëœì§€ìŠ¤í„° | 4 | 200ì› | 800ì› |
| ë‹¤ì´ì˜¤ë“œ | 4 | 100ì› | 400ì› |
| ë‹¨ìëŒ€ | 5 | 500ì› | 2,500ì› |
| ê¸°íƒ€ ë¶€í’ˆ | - | 2,000ì› | 2,000ì› |
| **ì´ê³„** | | | **14,700ì›** |

---

#### 7.2.2 ì†”ë ˆë…¸ì´ë“œ ë°¸ë¸Œ ì œì–´ ëª¨ë“ˆ

**ì‚¬ì–‘**
- MCU: ESP32-C3
- ì¶œë ¥: 2ì±„ë„ ê³ ì „ë¥˜ MOSFET
- ì „ë¥˜: ìµœëŒ€ 5A per channel
- ìš©ë„: ì–‘ì•¡ ê³µê¸‰, ë¬¼ ê³µê¸‰
- ë³´í˜¸: ê³¼ì „ë¥˜ ì°¨ë‹¨, ì—­ì „ì•• ë°©ì§€

**BOM**
| ë¶€í’ˆ | ìˆ˜ëŸ‰ | ë‹¨ê°€ | í•©ê³„ |
|------|------|------|------|
| ESP32-C3 ëª¨ë“ˆ | 1 | 3,000ì› | 3,000ì› |
| MOSFET (IRLZ44N) | 2 | 800ì› | 1,600ì› |
| ì „ë¥˜ ì„¼ì„œ | 2 | 2,000ì› | 4,000ì› |
| ê¸°íƒ€ ë¶€í’ˆ | - | 2,000ì› | 2,000ì› |
| **ì´ê³„** | | | **10,600ì›** |

---

### 7.3 í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“ˆ

#### 7.3.1 ì˜¬ì¸ì› í™˜ê²½ ì œì–´ ëª¨ë“ˆ

**ì‚¬ì–‘**
- MCU: ESP32-S3 (ë” ë§ì€ GPIO)
- ì„¼ì„œ:
  - DHT22 (ì˜¨ìŠµë„)
  - BH1750 (ì¡°ë„)
  - MH-Z19B (CO2)
- ì•¡ì¶”ì—ì´í„°:
  - 2ì±„ë„ ë¦´ë ˆì´ (í™˜í’ê¸°, íˆí„°)
- ë””ìŠ¤í”Œë ˆì´: OLED 128Ã—64 (ì„ íƒ)

**BOM**
| ë¶€í’ˆ | ìˆ˜ëŸ‰ | ë‹¨ê°€ | í•©ê³„ |
|------|------|------|------|
| ESP32-S3 ëª¨ë“ˆ | 1 | 5,000ì› | 5,000ì› |
| DHT22 | 1 | 2,000ì› | 2,000ì› |
| BH1750 | 1 | 1,500ì› | 1,500ì› |
| MH-Z19B | 1 | 18,000ì› | 18,000ì› |
| ë¦´ë ˆì´ | 2 | 1,500ì› | 3,000ì› |
| OLED (ì„ íƒ) | 1 | 3,000ì› | 3,000ì› |
| ê¸°íƒ€ ë¶€í’ˆ | - | 3,000ì› | 3,000ì› |
| **ì´ê³„** | | | **35,500ì›** |

---

## 8. ì œì‘ ë° ë¹„ìš©

### 8.1 PCB ì œì‘ (10ê°œ ê¸°ì¤€)

**ì¤‘êµ­ ì—…ì²´ (JLCPCB, PCBWay)**
| í•­ëª© | ì‚¬ì–‘ | ê°€ê²© |
|------|------|------|
| PCB | 50Ã—40mm, 2ì¸µ, 10ê°œ | $5~10 |
| ë°°ì†¡ | DHL (5ì¼) | $15~20 |
| **ì´ê³„** | | **$20~30 (2.5~4ë§Œì›)** |
| **ê°œë‹¹** | | **2,500~4,000ì›** |

**êµ­ë‚´ ì—…ì²´ (ì˜ˆ: ì½”ì½”ë„›)**
| í•­ëª© | ì‚¬ì–‘ | ê°€ê²© |
|------|------|------|
| PCB | 50Ã—40mm, 2ì¸µ, 10ê°œ | 30,000ì› |
| ë°°ì†¡ | êµ­ë‚´ (2ì¼) | ë¬´ë£Œ |
| **ì´ê³„** | | **30,000ì›** |
| **ê°œë‹¹** | | **3,000ì›** |

### 8.2 ë¶€í’ˆ êµ¬ë§¤

**AliExpress / íƒ€ì˜¤ë°”ì˜¤**
- ë°°ì†¡: 2~4ì£¼
- ê°€ê²©: ê°€ì¥ ì €ë ´ (50% í• ì¸)
- í’ˆì§ˆ: ê²€ì¦ í•„ìš”

**êµ­ë‚´ ì—…ì²´ (ICbanQ, ë””ë°”ì´ìŠ¤ë§ˆíŠ¸)**
- ë°°ì†¡: 1~3ì¼
- ê°€ê²©: ì¤‘ê°„
- í’ˆì§ˆ: ì‹ ë¢°ì„± ë†’ìŒ

**ê¶Œì¥**: í”„ë¡œí† íƒ€ì…ì€ êµ­ë‚´, ì–‘ì‚°ì€ í•´ì™¸

### 8.3 ì¡°ë¦½

**ìˆ˜ë™ ì¡°ë¦½**
- ë„êµ¬: ì¸ë‘ê¸°, ë©€í‹°ë¯¸í„°, í•€ì…‹
- ì‹œê°„: ëª¨ë“ˆë‹¹ 30ë¶„~1ì‹œê°„
- ë¹„ìš©: ë¬´ë£Œ (ì§ì ‘ ì‘ì—…)

**PCBA ì„œë¹„ìŠ¤**
- JLCPCB SMT ì„œë¹„ìŠ¤
- BOM ì—…ë¡œë“œ + ë¶€í’ˆ ìë™ ì¥ì°©
- ì¶”ê°€ ë¹„ìš©: $30~50 (10ê°œ ê¸°ì¤€)

### 8.4 ì´ ì œì‘ ë¹„ìš© (10ê°œ ê¸°ì¤€)

#### ì˜¨ìŠµë„ ì„¼ì„œ ëª¨ë“ˆ
| í•­ëª© | ë‹¨ê°€ | 10ê°œ |
|------|------|------|
| PCB | 3,000ì› | 30,000ì› |
| ë¶€í’ˆ | 5,800ì› | 58,000ì› |
| ì¡°ë¦½ | ë¬´ë£Œ | ë¬´ë£Œ |
| **ì´ê³„** | **8,800ì›** | **88,000ì›** |

#### 4ì±„ë„ ë¦´ë ˆì´ ëª¨ë“ˆ
| í•­ëª© | ë‹¨ê°€ | 10ê°œ |
|------|------|------|
| PCB | 3,000ì› | 30,000ì› |
| ë¶€í’ˆ | 11,700ì› | 117,000ì› |
| ì¡°ë¦½ | ë¬´ë£Œ | ë¬´ë£Œ |
| **ì´ê³„** | **14,700ì›** | **147,000ì›** |

---

## 9. ì„¤ì¹˜ ë° ì‚¬ìš©ë²•

### 9.1 ì´ˆê¸° ì„¤ì • (ìµœì´ˆ 1íšŒ)

**Step 1: WiFi ì„¤ì • (SmartConfig)**

1. ëª¨ë“ˆì— ì „ì› ì—°ê²° (5V)
2. LEDê°€ ë¹ ë¥´ê²Œ ê¹œë¹¡ì„ (SmartConfig ëª¨ë“œ)
3. ìŠ¤ë§ˆíŠ¸í°ì— "ESP Touch" ì•± ì„¤ì¹˜
   - iOS: App Store
   - Android: Google Play
4. ì•±ì—ì„œ WiFi SSID/Password ì…ë ¥
5. ëª¨ë“ˆì´ ìë™ìœ¼ë¡œ WiFi ì—°ê²°
6. LEDê°€ ì²œì²œíˆ ê¹œë¹¡ì„ (ì •ìƒ ë™ì‘)

**Step 2: MQTT Broker ì„¤ì •**

ëª¨ë“ˆì€ í•˜ë“œì½”ë”©ëœ MQTT Broker IPë¡œ ìë™ ì—°ê²°
```cpp
const char* MQTT_SERVER = "192.168.1.100"; // ìˆ˜ì • í•„ìš” ì‹œ ì¬ì»´íŒŒì¼
```

ë˜ëŠ” ì›¹ ì„¤ì • í˜ì´ì§€ ì œê³µ (ì„ íƒì )
```
http://192.168.1.xxx  (ëª¨ë“ˆ IP)
â†’ WiFi/MQTT ì„¤ì • ë³€ê²½
```

### 9.2 ì¼ìƒ ì‚¬ìš©

**ì „ì›ë§Œ ì—°ê²°í•˜ë©´ ë!**
```
1. ì „ì› ê³µê¸‰ (5V DC)
   â†“
2. ìë™ WiFi ì—°ê²°
   â†“
3. ìë™ MQTT ì—°ê²°
   â†“
4. ì„¼ì„œ ë°ì´í„° ìë™ ì „ì†¡ ë˜ëŠ” ì œì–´ ëŒ€ê¸°
```

### 9.3 ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸

**Grafana ëŒ€ì‹œë³´ë“œ**
```
http://192.168.1.100:3000
- ì˜¨ë„/ìŠµë„ ê·¸ë˜í”„
- ë¦´ë ˆì´ ìƒíƒœ
- ëª¨ë“ˆ ì˜¨ë¼ì¸ ìƒíƒœ
```

**Node-RED ì œì–´**
```
http://192.168.1.100:1880
- ìˆ˜ë™ ì œì–´ ë²„íŠ¼
- ìë™í™” ë£° ì„¤ì •
- ì•Œë¦¼ ì„¤ì •
```

### 9.4 ë¬¸ì œ í•´ê²°

| ë¬¸ì œ | LED ìƒíƒœ | í•´ê²° ë°©ë²• |
|------|---------|----------|
| WiFi ì—°ê²° ì‹¤íŒ¨ | ë¹ ë¥¸ ê¹œë¹¡ì„ | SmartConfig ì¬ì‹œë„ |
| MQTT ì—°ê²° ì‹¤íŒ¨ | ëŠë¦° ê¹œë¹¡ì„ | Broker IP í™•ì¸ |
| ì„¼ì„œ ì˜¤ë¥˜ | í•­ìƒ ì¼œì§ | ì„¼ì„œ ì—°ê²° í™•ì¸ |
| ì „ì› ë¶€ì¡± | ë¶ˆê·œì¹™ ê¹œë¹¡ì„ | ì „ì› ê³µê¸‰ í™•ì¸ |

---

## 10. í…ŒìŠ¤íŠ¸ ê³„íš

### 10.1 í•˜ë“œì›¨ì–´ í…ŒìŠ¤íŠ¸

#### ì „ì› í…ŒìŠ¤íŠ¸
```
â–¡ ì…ë ¥ ì „ì•• ë²”ìœ„ í…ŒìŠ¤íŠ¸ (4.5V~5.5V)
â–¡ ì¶œë ¥ ì „ì•• ì•ˆì •ì„± (3.3V Â±0.1V)
â–¡ ë¦¬í”Œ ë…¸ì´ì¦ˆ ì¸¡ì • (<100mV)
â–¡ ì „ë¥˜ ì†Œë¹„ ì¸¡ì • (ê° ëª¨ë“œë³„)
â–¡ ê³¼ì „ë¥˜ ë³´í˜¸ ë™ì‘ í™•ì¸
```

#### GPIO í…ŒìŠ¤íŠ¸
```
â–¡ ëª¨ë“  GPIO ì…ì¶œë ¥ ë™ì‘ í™•ì¸
â–¡ ADC ì •í™•ë„ í…ŒìŠ¤íŠ¸ (ë©€í‹°ë¯¸í„° ëŒ€ì¡°)
â–¡ I2C/UART í†µì‹  í™•ì¸
â–¡ PWM ì¶œë ¥ í™•ì¸
```

#### ì„¼ì„œ í…ŒìŠ¤íŠ¸
```
â–¡ DHT22 ì˜¨ìŠµë„ ì •í™•ë„ (í‘œì¤€ ì„¼ì„œ ëŒ€ì¡°)
â–¡ EC/pH ì„¼ì„œ ë³´ì • ë° ì •í™•ë„
â–¡ ì¥ì‹œê°„ ì•ˆì •ì„± í…ŒìŠ¤íŠ¸ (24ì‹œê°„)
```

#### ë¦´ë ˆì´ í…ŒìŠ¤íŠ¸
```
â–¡ ê°œí ë™ì‘ í™•ì¸
â–¡ ì ‘ì  ì „ì••/ì „ë¥˜ í…ŒìŠ¤íŠ¸
â–¡ ìˆ˜ëª… í…ŒìŠ¤íŠ¸ (10,000íšŒ ë°˜ë³µ)
```

### 10.2 ì†Œí”„íŠ¸ì›¨ì–´ í…ŒìŠ¤íŠ¸

#### WiFi í…ŒìŠ¤íŠ¸
```
â–¡ ìë™ ì—°ê²° ì„±ê³µë¥  (10íšŒ ì¤‘ 10íšŒ)
â–¡ ì¬ì—°ê²° ì‹œê°„ ì¸¡ì • (<10ì´ˆ)
â–¡ ì‹ í˜¸ ì„¸ê¸°ë³„ ì•ˆì •ì„± (-30dBm ~ -80dBm)
â–¡ ë¼ìš°í„° ì¬ë¶€íŒ… í›„ ìë™ ë³µêµ¬
```

#### MQTT í…ŒìŠ¤íŠ¸
```
â–¡ Broker ì—°ê²° ì„±ê³µë¥ 
â–¡ QoS 0, 1, 2 ë©”ì‹œì§€ ì „ë‹¬ í™•ì¸
â–¡ ë©”ì‹œì§€ ì§€ì—° ì‹œê°„ ì¸¡ì • (<100ms)
â–¡ ë„¤íŠ¸ì›Œí¬ ëŠê¹€ í›„ ì¬ì—°ê²°
â–¡ LWT (Last Will) ë™ì‘ í™•ì¸
```

#### ë°ì´í„° ì •í™•ì„± í…ŒìŠ¤íŠ¸
```
â–¡ JSON íŒŒì‹± ì˜¤ë¥˜ ì—†ìŒ
â–¡ íƒ€ì„ìŠ¤íƒ¬í”„ ì •í™•ë„
â–¡ ì„¼ì„œ ê°’ ë²”ìœ„ ê²€ì¦
â–¡ ì´ìƒê°’ í•„í„°ë§
```

### 10.3 í†µí•© í…ŒìŠ¤íŠ¸

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ì„¼ì„œ â†’ ëŒ€ì‹œë³´ë“œ
```
1. ì„¼ì„œ ëª¨ë“ˆ ì „ì› ON
2. WiFi/MQTT ìë™ ì—°ê²° í™•ì¸
3. Grafanaì—ì„œ ì‹¤ì‹œê°„ ë°ì´í„° í™•ì¸
4. 1ë¶„ë§ˆë‹¤ ì—…ë°ì´íŠ¸ í™•ì¸
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ëŒ€ì‹œë³´ë“œ â†’ ì•¡ì¶”ì—ì´í„°
```
1. Node-REDì—ì„œ ë¦´ë ˆì´ ON ëª…ë ¹
2. MQTT ë©”ì‹œì§€ ì „ì†¡ í™•ì¸
3. ë¦´ë ˆì´ ëª¨ë“ˆ ë™ì‘ í™•ì¸ (LED)
4. ìƒíƒœ í”¼ë“œë°± ìˆ˜ì‹  í™•ì¸
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ìë™í™”
```
1. Node-REDì—ì„œ ë£° ì„¤ì • (ì˜¨ë„ > 28Â°C â†’ í™˜í’ê¸° ON)
2. ì˜¨ë„ ì„¼ì„œì— ì—´í’ê¸°ë¡œ ê°€ì—´
3. ìë™ìœ¼ë¡œ í™˜í’ê¸° ë¦´ë ˆì´ ON í™•ì¸
4. ì˜¨ë„ í•˜ê°• í›„ ë¦´ë ˆì´ OFF í™•ì¸
```

### 10.4 í™˜ê²½ í…ŒìŠ¤íŠ¸

#### ì˜¨ë„ í…ŒìŠ¤íŠ¸
```
â–¡ ì €ì˜¨: -10Â°C (ì‹¤ì™¸ ë™ì‘)
â–¡ ê³ ì˜¨: 60Â°C (ì˜¨ì‹¤ ë‚´ë¶€)
â–¡ ì˜¨ë„ ì¶©ê²©: -10Â°C â†” 60Â°C ë°˜ë³µ
```

#### ìŠµë„ í…ŒìŠ¤íŠ¸
```
â–¡ ê±´ì¡°: 10% RH
â–¡ ê³ ìŠµ: 90% RH
â–¡ ê²°ë¡œ ë°©ì§€ í™•ì¸ (ë°©ìˆ˜ ì½”íŒ…)
```

#### ì „ìíŒŒ ì í•©ì„± (EMC)
```
â–¡ ì „ìíŒŒ ë°©ì¶œ (EMI) ì¸¡ì •
â–¡ ì „ìíŒŒ ë‚´ì„± (EMS) í…ŒìŠ¤íŠ¸
â–¡ WiFi ê°„ì„­ ìµœì†Œí™” í™•ì¸
```

### 10.5 ì‹ ë¢°ì„± í…ŒìŠ¤íŠ¸

#### ì¥ê¸° ì•ˆì •ì„±
```
â–¡ ì—°ì† ìš´ì „: 7ì¼ ë¬´ì¤‘ë‹¨
â–¡ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì—†ìŒ
â–¡ WiFi/MQTT ì¬ì—°ê²° íšŸìˆ˜ ê¸°ë¡
```

#### ì „ì› ì‚¬ì´í´
```
â–¡ 1,000íšŒ ì „ì› ON/OFF ë°˜ë³µ
â–¡ ë¶€íŒ… ì‹œê°„ ì¼ê´€ì„±
â–¡ ì„¤ì • ì €ì¥ í™•ì¸ (NVS)
```

---

## 11. í™•ì¥ ê¸°ëŠ¥

### 11.1 ì›¹ ì„¤ì • í˜ì´ì§€

**ESP32 AsyncWebServer ì‚¬ìš©**
```cpp
#include <ESPAsyncWebServer.h>

AsyncWebServer server(80);

void setupWebServer() {
    // ì„¤ì • í˜ì´ì§€
    server.on("/", HTTP_GET, [](AsyncWebServerRequest *request){
        String html = R"(
        <html>
        <body>
            <h1>SmartFarm WiFi Module</h1>
            <form action="/config" method="POST">
                WiFi SSID: <input name="ssid"><br>
                Password: <input name="pass"><br>
                MQTT Server: <input name="mqtt"><br>
                <input type="submit" value="Save">
            </form>
        </body>
        </html>
        )";
        request->send(200, "text/html", html);
    });
    
    // ì„¤ì • ì €ì¥
    server.on("/config", HTTP_POST, [](AsyncWebServerRequest *request){
        String ssid = request->arg("ssid");
        String pass = request->arg("pass");
        String mqtt = request->arg("mqtt");
        
        // NVSì— ì €ì¥
        saveConfig(ssid, pass, mqtt);
        
        request->send(200, "text/plain", "Saved! Rebooting...");
        delay(1000);
        ESP.restart();
    });
    
    server.begin();
}
```

### 11.2 ìë™ ë°œê²¬ (Discovery)

**mDNS (Multicast DNS)**
```cpp
#include <ESPmDNS.h>

void setupMDNS() {
    if (MDNS.begin("smartfarm-module1")) {
        Serial.println("mDNS responder started");
        MDNS.addService("mqtt", "tcp", 1883);
    }
}

// ë„¤íŠ¸ì›Œí¬ì—ì„œ ë°œê²¬:
// smartfarm-module1.local
```

### 11.3 LED ìƒíƒœ í‘œì‹œ

```cpp
#define LED_PIN 8

enum LEDStatus {
    OFF,              // ì „ì› ì—†ìŒ
    SLOW_BLINK,       // WiFi ì—°ê²° ì¤‘ (1ì´ˆ ê°„ê²©)
    FAST_BLINK,       // MQTT ì—°ê²° ì¤‘ (0.2ì´ˆ ê°„ê²©)
    HEARTBEAT,        // ì •ìƒ ë™ì‘ (2ì´ˆë§ˆë‹¤ ì§§ê²Œ)
    SOLID_ON          // ì˜¤ë¥˜
};

void updateLED(LEDStatus status) {
    static unsigned long lastToggle = 0;
    static bool ledState = false;
    unsigned long now = millis();
    
    switch (status) {
        case SLOW_BLINK:
            if (now - lastToggle > 1000) {
                ledState = !ledState;
                digitalWrite(LED_PIN, ledState);
                lastToggle = now;
            }
            break;
        // ... ê¸°íƒ€ ìƒíƒœ
    }
}
```

### 11.4 ë°°í„°ë¦¬ ì§€ì› (ì„ íƒ)

**ë¦¬íŠ¬ ë°°í„°ë¦¬ + ì¶©ì „ ëª¨ë“ˆ**
```
- 18650 ë¦¬íŠ¬ ë°°í„°ë¦¬ (3.7V, 3000mAh)
- TP4056 ì¶©ì „ ëª¨ë“ˆ
- ë°°í„°ë¦¬ ì „ì•• ëª¨ë‹ˆí„°ë§ (ADC)
- Deep Sleepìœ¼ë¡œ ìˆ˜ëª… ì—°ì¥
```

**ì˜ˆìƒ ë°°í„°ë¦¬ ìˆ˜ëª…**
| ëª¨ë“œ | ì „ë¥˜ | ì‹œê°„ | ìˆ˜ëª… |
|------|------|------|------|
| ì—°ì† í™œì„± | 80mA | 24ì‹œê°„ | ~37ì‹œê°„ |
| Sleep 60ì´ˆ | 10mA | í‰ê·  | ~12ì¼ |
| Deep Sleep 10ë¶„ | 1mA | í‰ê·  | ~4ê°œì›” |

---

## 12. ë¶€ë¡

### 12.1 í•„ìš” ë„êµ¬ ëª©ë¡

**í•˜ë“œì›¨ì–´ ì œì‘**
```
â–¡ ì¸ë‘ê¸° (ì˜¨ë„ ì¡°ì ˆì‹, 300~400Â°C)
â–¡ ì¸ë‘ê¸° íŒ (0.5mm ë¾°ì¡±í•œ íŒ)
â–¡ ë•œë‚© (ë¬´ì—°, 0.8mm)
â–¡ í”ŒëŸ­ìŠ¤
â–¡ í•€ì…‹ (ESD ì•ˆì „)
â–¡ ë©€í‹°ë¯¸í„°
â–¡ ì˜¤ì‹¤ë¡œìŠ¤ì½”í”„ (ì„ íƒ)
â–¡ ì „ì› ê³µê¸‰ê¸° (5V, 2A)
â–¡ ë‹ë³´ê¸° ë˜ëŠ” í˜„ë¯¸ê²½
```

**ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ**
```
â–¡ Arduino IDE ë˜ëŠ” PlatformIO
â–¡ USB-UART ë³€í™˜ê¸° (CH340, CP2102)
â–¡ Git (ë²„ì „ ê´€ë¦¬)
â–¡ MQTT í´ë¼ì´ì–¸íŠ¸ (MQTT Explorer)
```

### 12.2 ì°¸ê³  ìë£Œ

**ê³µì‹ ë¬¸ì„œ**
- ESP32-C3 Datasheet: https://www.espressif.com/sites/default/files/documentation/esp32-c3_datasheet_en.pdf
- Arduino-ESP32: https://github.com/espressif/arduino-esp32
- PubSubClient: https://pubsubclient.knolleary.net/

**ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸**
- Tasmota: https://tasmota.github.io/
- ESPHome: https://esphome.io/
- OpenMQTTGateway: https://github.com/1technophile/OpenMQTTGateway

**ì»¤ë®¤ë‹ˆí‹°**
- ESP32 Forum: https://www.esp32.com/
- Arduino Forum: https://forum.arduino.cc/
- Reddit r/esp32: https://www.reddit.com/r/esp32/

### 12.3 ìƒ˜í”Œ ì½”ë“œ ì €ì¥ì†Œ

**GitHub ì €ì¥ì†Œ êµ¬ì¡°**
```
smartfarm-wifi-modules/
â”œâ”€â”€ hardware/
â”‚   â”œâ”€â”€ pcb/                  # KiCad í”„ë¡œì íŠ¸
â”‚   â”‚   â”œâ”€â”€ sensor_module/
â”‚   â”‚   â”œâ”€â”€ relay_module/
â”‚   â”‚   â””â”€â”€ library/          # ê³µí†µ ì‹¬ë³¼/í’‹í”„ë¦°íŠ¸
â”‚   â”œâ”€â”€ bom/                  # BOM íŒŒì¼
â”‚   â””â”€â”€ gerber/               # Gerber íŒŒì¼
â”‚
â”œâ”€â”€ firmware/
â”‚   â”œâ”€â”€ common/               # ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”‚   â”œâ”€â”€ wifi_manager/
â”‚   â”‚   â”œâ”€â”€ mqtt_client/
â”‚   â”‚   â””â”€â”€ ota_update/
â”‚   â”œâ”€â”€ sensor_modules/
â”‚   â”‚   â”œâ”€â”€ temp_humidity/
â”‚   â”‚   â”œâ”€â”€ ec_ph/
â”‚   â”‚   â””â”€â”€ soil_moisture/
â”‚   â”œâ”€â”€ actuator_modules/
â”‚   â”‚   â”œâ”€â”€ relay_4ch/
â”‚   â”‚   â””â”€â”€ valve_controller/
â”‚   â””â”€â”€ platformio.ini
â”‚
â”œâ”€â”€ server/                   # Raspberry Pi ì„¤ì •
â”‚   â”œâ”€â”€ mosquitto/            # MQTT Broker
â”‚   â”œâ”€â”€ node-red/             # ìë™í™” í”Œë¡œìš°
â”‚   â”œâ”€â”€ grafana/              # ëŒ€ì‹œë³´ë“œ
â”‚   â””â”€â”€ docker-compose.yml
â”‚
â”œâ”€â”€ docs/                     # ë¬¸ì„œ
â”‚   â”œâ”€â”€ assembly_guide.md
â”‚   â”œâ”€â”€ user_manual.md
â”‚   â””â”€â”€ api_reference.md
â”‚
â””â”€â”€ README.md
```

### 12.4 ë¼ì´ì„¼ìŠ¤

**í•˜ë“œì›¨ì–´**
- CERN Open Hardware Licence v2 - Strongly Reciprocal (CERN-OHL-S-2.0)

**ì†Œí”„íŠ¸ì›¨ì–´**
- MIT License

**ë¬¸ì„œ**
- Creative Commons Attribution 4.0 International (CC BY 4.0)

---

## 13. ë¡œë“œë§µ

### Phase 1: í”„ë¡œí† íƒ€ì… (1ê°œì›”)
- [x] ì‹œìŠ¤í…œ ì„¤ê³„ ì™„ë£Œ
- [ ] PCB ì„¤ê³„ ë° ì œì‘ (2ì£¼)
- [ ] íŒì›¨ì–´ ê°œë°œ (2ì£¼)
- [ ] ì´ˆê¸° í…ŒìŠ¤íŠ¸

### Phase 2: ë² íƒ€ í…ŒìŠ¤íŠ¸ (2ê°œì›”)
- [ ] 10ê°œ ëª¨ë“ˆ ì œì‘
- [ ] ì‹¤ì œ ì˜¨ì‹¤ì—ì„œ í…ŒìŠ¤íŠ¸
- [ ] í”¼ë“œë°± ìˆ˜ì§‘ ë° ê°œì„ 

### Phase 3: ì–‘ì‚° ì¤€ë¹„ (3ê°œì›”)
- [ ] ìµœì¢… ë””ìì¸ í™•ì •
- [ ] CE/FCC ì¸ì¦ (ì„ íƒ)
- [ ] ì‚¬ìš©ì ë§¤ë‰´ì–¼ ì‘ì„±
- [ ] íŒë§¤ ì‹œì‘

### Phase 4: ì¶”ê°€ ëª¨ë“ˆ ê°œë°œ
- [ ] ì¹´ë©”ë¼ ëª¨ë“ˆ (ESP32-CAM)
- [ ] LoRa ì¥ê±°ë¦¬ í†µì‹  ëª¨ë“ˆ
- [ ] íƒœì–‘ê´‘ ì „ì› ëª¨ë“ˆ

---

## 14. ê²°ë¡ 

### 14.1 í”„ë¡œì íŠ¸ ì¥ì 

âœ… **ì§„ì •í•œ í”ŒëŸ¬ê·¸ì•¤í”Œë ˆì´**
- ì „ì›ë§Œ ì—°ê²°í•˜ë©´ ìë™ìœ¼ë¡œ ëª¨ë“  ê²ƒì´ ì„¤ì •ë¨
- ì‚¬ìš©ìê°€ ë³µì¡í•œ ì„¤ì • ë¶ˆí•„ìš”

âœ… **ì €ë¹„ìš© ê³ íš¨ìœ¨**
- ëª¨ë“ˆë‹¹ 5,000ì›~30,000ì›
- ê¸°ì¡´ ìƒìš© ì œí’ˆ ëŒ€ë¹„ 1/5~1/10 ë¹„ìš©

âœ… **ëª¨ë“ˆì‹ ì„¤ê³„**
- í•„ìš”ì— ë”°ë¼ ëª¨ë“ˆ ì¶”ê°€/êµì²´ ê°€ëŠ¥
- í™•ì¥ì„± ìš°ìˆ˜

âœ… **ì˜¤í”ˆì†ŒìŠ¤**
- í•˜ë“œì›¨ì–´/ì†Œí”„íŠ¸ì›¨ì–´ ëª¨ë‘ ê³µê°œ
- ì»¤ë®¤ë‹ˆí‹° ê¸°ì—¬ ê°€ëŠ¥

âœ… **ë¬´ì„  í†µì‹ **
- ë°°ì„  ì—†ì´ WiFië¡œ í†µì‹ 
- ì„¤ì¹˜ ê°„í¸

### 14.2 ì ìš© íš¨ê³¼

**500í‰ ìŠ¤ë§ˆíŠ¸íŒœ ê¸°ì¤€**

| í•­ëª© | ê¸°ì¡´ ìœ ì„  | WiFi ëª¨ë“ˆ | ì ˆê° íš¨ê³¼ |
|------|---------|-----------|----------|
| ì„¼ì„œ ë…¸ë“œ | 10ê°œ Ã— 150,000ì› | 10ê°œ Ã— 10,000ì› | **1,400,000ì›** |
| ë°°ì„  ë¹„ìš© | 500,000ì› | 0ì› | **500,000ì›** |
| ì„¤ì¹˜ ì‹œê°„ | 2ì¼ | 4ì‹œê°„ | **ì¸ê±´ë¹„ ì ˆê°** |
| ìœ ì§€ë³´ìˆ˜ | ì–´ë ¤ì›€ | ì‰¬ì›€ | **ì‹œê°„ ì ˆê°** |
| **ì´ ì ˆê°** | | | **ì•½ 200ë§Œì›** |

### 14.3 í–¥í›„ ê°œì„  ì‚¬í•­

1. **ë³´ì•ˆ ê°•í™”**: TLS/SSL ì•”í˜¸í™”, ì¸ì¦ì„œ ê¸°ë°˜ ì¸ì¦
2. **ë©”ì‹œ ë„¤íŠ¸ì›Œí¬**: ESP-MESHë¡œ ì¥ê±°ë¦¬ í™•ì¥
3. **AI í†µí•©**: Edge AIë¡œ ë¡œì»¬ ì˜ì‚¬ê²°ì •
4. **ì—ë„ˆì§€ í•˜ë² ìŠ¤íŒ…**: íƒœì–‘ê´‘ íŒ¨ë„ í†µí•©
5. **ì¼€ì´ìŠ¤ ë””ìì¸**: ë°©ìˆ˜/ë°©ì§„ ì¼€ì´ìŠ¤ ì„¤ê³„

---

**í”„ë¡œì íŠ¸ ì—°ë½ì²˜**  
ì´ë©”ì¼: smartfarm@example.com  
GitHub: https://github.com/smartfarm-wifi-modules

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025ë…„ 10ì›” 20ì¼
